\hypertarget{classSMImp_1_1TrustedParty}{}\section{S\+M\+Imp\+:\+:Trusted\+Party Class Reference}
\label{classSMImp_1_1TrustedParty}\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}


Trusted Third Party protocol implementation.  




{\ttfamily \#include $<$Trusted\+Party.\+h$>$}

Inheritance diagram for S\+M\+Imp\+:\+:Trusted\+Party\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{classSMImp_1_1TrustedParty}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classSMImp_1_1TrustedParty_aec9d85830faf563a55c67b637b38bc0a}{Trusted\+Party} (Integer)
\item 
\hyperlink{classSMImp_1_1TrustedParty_ad48b557601e6793a80b9b4b42d586da1}{Trusted\+Party} (Integer, \hyperlink{classTTPAdapter}{T\+T\+P\+Adapter} $\ast$)
\item 
virtual \hyperlink{classSMImp_1_1TrustedParty_a93dd8343a752486f8a47691b429ad6a3}{$\sim$\+Trusted\+Party} ()
\item 
char $\ast$ \hyperlink{classSMImp_1_1TrustedParty_ab15efea2439c964eec1f0cdae82843ac}{get\+Message} ()
\item 
void \hyperlink{classSMImp_1_1TrustedParty_adc01721f3200888877174376a5b2464f}{register\+SM} (int)
\item 
void \hyperlink{classSMImp_1_1TrustedParty_aa8343369b112c07a86ab42a9ee64228b}{add\+Data\+To\+SM} (int \hyperlink{classSMImp_1_1Requester_a16911083f2e3fc903ed3e6e7ca2a58b1}{id}, Integer $\ast$data)
\item 
\hyperlink{classList}{List}$<$ Integer $>$ $\ast$ \hyperlink{classSMImp_1_1TrustedParty_a979f9046e92d8be8fd97b1f3bc92dcd0}{get\+SM} (int \hyperlink{classSMImp_1_1Requester_a16911083f2e3fc903ed3e6e7ca2a58b1}{id})
\item 
\hyperlink{classList}{List}$<$ Integer $>$ $\ast$ \hyperlink{classSMImp_1_1TrustedParty_a8c0452d2d9842a1c24ebf6dffac9529a}{get\+Random\+SM} ()
\item 
\hyperlink{classIterator}{Iterator}$<$ \hyperlink{classList}{List}$<$ Integer $>$ $>$ $\ast$ \hyperlink{classSMImp_1_1TrustedParty_a01cbd1bd12aaca134b0730bd2a6eb933}{get\+S\+M\+Iterator} ()
\item 
\hyperlink{structSMImp_1_1Packet}{Packet} \hyperlink{classSMImp_1_1TrustedParty_a34334b73f543168b6270a8bb36de04c3}{confirm\+Session} (Integer req, Integer sm\+Id, \hyperlink{structSMImp_1_1Key}{Key} sm\+Key)
\item 
bool \hyperlink{classSMImp_1_1TrustedParty_a889787f394517703c1d9d2dfd9b9ff9b}{recieve\+H\+M\+AC} (Integer length, Integer c1, Integer c2, Integer sm\+Id, \hyperlink{structSMImp_1_1Key}{Key} sm\+Key, Integer r)
\item 
Integer \hyperlink{classSMImp_1_1TrustedParty_ab812aac2ce15865341874f1cd9550ba4}{recieve\+Data} (Integer length, Integer c1, Integer c2, Integer sm\+Id, Integer time\+Stamp)
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Trusted Third Party protocol implementation. 

Most variables have been named after their respective names given in the original research paper available \href{https://www.researchgate.net/publication/305077004_Secure_and_efficient_protection_of_consumer_privacy_in_Advanced_Metering_Infrastructure_supporting_fine-grained_data_analysis}{\tt here}. See section 5 (Page 7) for the beginning of the protocol implementation. 

Definition at line 15 of file Trusted\+Party.\+h.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classSMImp_1_1TrustedParty_aec9d85830faf563a55c67b637b38bc0a}\label{classSMImp_1_1TrustedParty_aec9d85830faf563a55c67b637b38bc0a}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!Trusted\+Party@{Trusted\+Party}}
\index{Trusted\+Party@{Trusted\+Party}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{Trusted\+Party()}{TrustedParty()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily S\+M\+Imp\+::\+Trusted\+Party\+::\+Trusted\+Party (\begin{DoxyParamCaption}\item[{Integer}]{i }\end{DoxyParamCaption})}



Definition at line 16 of file Trusted\+Party.\+cc.

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_ad48b557601e6793a80b9b4b42d586da1}\label{classSMImp_1_1TrustedParty_ad48b557601e6793a80b9b4b42d586da1}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!Trusted\+Party@{Trusted\+Party}}
\index{Trusted\+Party@{Trusted\+Party}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{Trusted\+Party()}{TrustedParty()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily S\+M\+Imp\+::\+Trusted\+Party\+::\+Trusted\+Party (\begin{DoxyParamCaption}\item[{Integer}]{i,  }\item[{\hyperlink{classTTPAdapter}{T\+T\+P\+Adapter} $\ast$}]{o }\end{DoxyParamCaption})}

For debugging. 

Definition at line 9 of file Trusted\+Party.\+cc.

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a93dd8343a752486f8a47691b429ad6a3}\label{classSMImp_1_1TrustedParty_a93dd8343a752486f8a47691b429ad6a3}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!````~Trusted\+Party@{$\sim$\+Trusted\+Party}}
\index{````~Trusted\+Party@{$\sim$\+Trusted\+Party}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{$\sim$\+Trusted\+Party()}{~TrustedParty()}}
{\footnotesize\ttfamily S\+M\+Imp\+::\+Trusted\+Party\+::$\sim$\+Trusted\+Party (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [virtual]}}



Definition at line 23 of file Trusted\+Party.\+cc.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classSMImp_1_1TrustedParty_aa8343369b112c07a86ab42a9ee64228b}\label{classSMImp_1_1TrustedParty_aa8343369b112c07a86ab42a9ee64228b}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!add\+Data\+To\+SM@{add\+Data\+To\+SM}}
\index{add\+Data\+To\+SM@{add\+Data\+To\+SM}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{add\+Data\+To\+S\+M()}{addDataToSM()}}
{\footnotesize\ttfamily void S\+M\+Imp\+::\+Trusted\+Party\+::add\+Data\+To\+SM (\begin{DoxyParamCaption}\item[{int}]{id,  }\item[{Integer $\ast$}]{data }\end{DoxyParamCaption})}

Adds arbitrary data to the local Smart Meter representation identified by id. 
\begin{DoxyParams}{Parameters}
{\em id} & ID of the Smart Meter to add data to. \\
\hline
{\em data} & Data to add to the local Smart Meter representation. \\
\hline
\end{DoxyParams}


Definition at line 49 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::add(), List$<$ T $>$\+::get(), and List$<$ T $>$\+::size().

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a34334b73f543168b6270a8bb36de04c3}\label{classSMImp_1_1TrustedParty_a34334b73f543168b6270a8bb36de04c3}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!confirm\+Session@{confirm\+Session}}
\index{confirm\+Session@{confirm\+Session}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{confirm\+Session()}{confirmSession()}}
{\footnotesize\ttfamily \hyperlink{structSMImp_1_1Packet}{Packet} S\+M\+Imp\+::\+Trusted\+Party\+::confirm\+Session (\begin{DoxyParamCaption}\item[{Integer}]{req,  }\item[{Integer}]{sm\+Id,  }\item[{\hyperlink{structSMImp_1_1Key}{Key}}]{sm\+Key }\end{DoxyParamCaption})}

Recieves session key exchange data from Smart Meter. 
\begin{DoxyParams}{Parameters}
{\em req} & Shared secret R for use with future encryption. \\
\hline
{\em sm\+Id} & ID (anonymous) for identifying the Smart Meter (used by \hyperlink{classSMImp_1_1TrustedParty_a979f9046e92d8be8fd97b1f3bc92dcd0}{get\+S\+M(int id)}). \\
\hline
{\em sm\+Key} & Public key of the Smart Meter. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\hyperlink{structSMImp_1_1Packet}{Packet} to be sent back to the Smart Meter. 
\end{DoxyReturn}


Definition at line 70 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::add(), S\+M\+Imp\+::\+H\+M\+A\+C\+Payload\+::c1, S\+M\+Imp\+::\+H\+M\+A\+C\+Payload\+::c2, S\+M\+Imp\+::\+Packet\+::dest, S\+M\+Imp\+::\+Master\+Key\+::g, List$<$ T $>$\+::get(), S\+M\+Imp\+::\+H\+M\+A\+C\+Payload\+::hmac, S\+M\+Imp\+::\+Requester\+::id, S\+M\+Imp\+::\+H\+M\+A\+C\+Payload\+::id, S\+M\+Imp\+::\+Master\+Key\+::p, S\+M\+Imp\+::\+Requester\+::params, S\+M\+Imp\+::\+Key\+::partial, S\+M\+Imp\+::\+Key\+::piece, S\+M\+Imp\+::\+Packet\+::pl, S\+M\+Imp\+::\+Requester\+::rng, S\+M\+Imp\+::\+Requester\+::shaone, S\+M\+Imp\+::\+H\+M\+A\+C\+Payload\+::time\+Stamp, and S\+M\+Imp\+::\+Master\+Key\+::x.

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_ab15efea2439c964eec1f0cdae82843ac}\label{classSMImp_1_1TrustedParty_ab15efea2439c964eec1f0cdae82843ac}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!get\+Message@{get\+Message}}
\index{get\+Message@{get\+Message}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{get\+Message()}{getMessage()}}
{\footnotesize\ttfamily char$\ast$ S\+M\+Imp\+::\+Trusted\+Party\+::get\+Message (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Helper function for the \hyperlink{classAdapter}{Adapter} to queuery the current message. \begin{DoxyReturn}{Returns}
message 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
message. 
\end{DoxySeeAlso}
\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a8c0452d2d9842a1c24ebf6dffac9529a}\label{classSMImp_1_1TrustedParty_a8c0452d2d9842a1c24ebf6dffac9529a}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!get\+Random\+SM@{get\+Random\+SM}}
\index{get\+Random\+SM@{get\+Random\+SM}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{get\+Random\+S\+M()}{getRandomSM()}}
{\footnotesize\ttfamily \hyperlink{classList}{List}$<$ Integer $>$ $\ast$ S\+M\+Imp\+::\+Trusted\+Party\+::get\+Random\+SM (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Gets a random Smart Meter representation for use with session key exchange. \begin{DoxyReturn}{Returns}
Local Smart Meter representation of arbitrary data. 
\end{DoxyReturn}


Definition at line 60 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::get\+Random().

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a979f9046e92d8be8fd97b1f3bc92dcd0}\label{classSMImp_1_1TrustedParty_a979f9046e92d8be8fd97b1f3bc92dcd0}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!get\+SM@{get\+SM}}
\index{get\+SM@{get\+SM}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{get\+S\+M()}{getSM()}}
{\footnotesize\ttfamily \hyperlink{classList}{List}$<$ Integer $>$ $\ast$ S\+M\+Imp\+::\+Trusted\+Party\+::get\+SM (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}

Gets local Smart Meter representation by ID 
\begin{DoxyParams}{Parameters}
{\em id} & Smart Meter ID to retrieve. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Local Smart Meter representation of arbitrary data. 
\end{DoxyReturn}


Definition at line 55 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::get().

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a01cbd1bd12aaca134b0730bd2a6eb933}\label{classSMImp_1_1TrustedParty_a01cbd1bd12aaca134b0730bd2a6eb933}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!get\+S\+M\+Iterator@{get\+S\+M\+Iterator}}
\index{get\+S\+M\+Iterator@{get\+S\+M\+Iterator}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{get\+S\+M\+Iterator()}{getSMIterator()}}
{\footnotesize\ttfamily \hyperlink{classIterator}{Iterator}$<$ \hyperlink{classList}{List}$<$ Integer $>$ $>$ $\ast$ S\+M\+Imp\+::\+Trusted\+Party\+::get\+S\+M\+Iterator (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Get an iterator to iterate over all available Smart Meters. \begin{DoxyReturn}{Returns}
\hyperlink{classIterator}{Iterator} to iterate with. 
\end{DoxyReturn}


Definition at line 65 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::iterator().

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_ab812aac2ce15865341874f1cd9550ba4}\label{classSMImp_1_1TrustedParty_ab812aac2ce15865341874f1cd9550ba4}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!recieve\+Data@{recieve\+Data}}
\index{recieve\+Data@{recieve\+Data}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{recieve\+Data()}{recieveData()}}
{\footnotesize\ttfamily Integer S\+M\+Imp\+::\+Trusted\+Party\+::recieve\+Data (\begin{DoxyParamCaption}\item[{Integer}]{length,  }\item[{Integer}]{c1,  }\item[{Integer}]{c2,  }\item[{Integer}]{sm\+Id,  }\item[{Integer}]{time\+Stamp }\end{DoxyParamCaption})}

Recieve, verify and decrypt energy usage data. 
\begin{DoxyParams}{Parameters}
{\em length} & Length of the message (unused as it is equivalent to the sum of the lengths of c1 and c2) \\
\hline
{\em c1} & Part 1 of the encrypted energy usage data. \\
\hline
{\em c2} & Part 2 of the encrypted energy usage data. \\
\hline
{\em sm\+Id} & ID (anonymous) of the Smart Meter the data originated from. \\
\hline
{\em time\+Stamp} & Timestamp of the data. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 if failed to verify. Any other value is the byte-\/encoded string of the data, see \hyperlink{classTTPAdapter_ab69604de63c3f769a10ec33168611274}{T\+T\+P\+Adapter\+::process\+Data\+From\+S\+M(omnetpp\+::c\+Message$\ast$ msg)} 
\end{DoxyReturn}


Definition at line 131 of file Trusted\+Party.\+cc.



References D\+E\+B\+UG, S\+M\+Imp\+::\+Master\+Key\+::g, List$<$ T $>$\+::get(), S\+M\+Imp\+::\+Master\+Key\+::p, S\+M\+Imp\+::\+Requester\+::params, and S\+M\+Imp\+::\+Requester\+::session\+Key.

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_a889787f394517703c1d9d2dfd9b9ff9b}\label{classSMImp_1_1TrustedParty_a889787f394517703c1d9d2dfd9b9ff9b}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!recieve\+H\+M\+AC@{recieve\+H\+M\+AC}}
\index{recieve\+H\+M\+AC@{recieve\+H\+M\+AC}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{recieve\+H\+M\+A\+C()}{recieveHMAC()}}
{\footnotesize\ttfamily bool S\+M\+Imp\+::\+Trusted\+Party\+::recieve\+H\+M\+AC (\begin{DoxyParamCaption}\item[{Integer}]{length,  }\item[{Integer}]{c1,  }\item[{Integer}]{c2,  }\item[{Integer}]{sm\+Id,  }\item[{\hyperlink{structSMImp_1_1Key}{Key}}]{sm\+Key,  }\item[{Integer}]{r }\end{DoxyParamCaption})}

Finishes the Session \hyperlink{structSMImp_1_1Key}{Key} exchange phase for the Trusted Third Party. 
\begin{DoxyParams}{Parameters}
{\em length} & Total length of the session key. Unlike \hyperlink{classSMImp_1_1TrustedParty_a889787f394517703c1d9d2dfd9b9ff9b}{recieve\+H\+M\+A\+C(\+Integer length, Integer c1, Integer c2, Integer id, Key sm\+Key, Integer r)} the sum of the lengths of c1 and c2 may be less than the length of the entire session key. \\
\hline
{\em c1} & Part 1 of the encrypted Session \hyperlink{structSMImp_1_1Key}{Key}. \\
\hline
{\em c2} & Part 2 of the encrypted Session \hyperlink{structSMImp_1_1Key}{Key}. \\
\hline
{\em sm\+Id} & ID (anonymous) of the Smart Meter the Session \hyperlink{structSMImp_1_1Key}{Key} originated from. \\
\hline
{\em sm\+Key} & Public key of Smart Meter. \\
\hline
{\em r} & shared-\/secret used for message verification. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Returns true if session key passed verification, false otherwise. 
\end{DoxyReturn}


Definition at line 180 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::add(), D\+E\+B\+UG, S\+M\+Imp\+::\+Master\+Key\+::g, List$<$ T $>$\+::get(), S\+M\+Imp\+::\+Requester\+::keys, S\+M\+Imp\+::\+Master\+Key\+::p, S\+M\+Imp\+::\+Requester\+::params, S\+M\+Imp\+::\+Key\+::partial, S\+M\+Imp\+::\+Key\+::piece, S\+M\+Imp\+::\+Key\+Pair\+::priv, and S\+M\+Imp\+::\+Requester\+::session\+Key.

\mbox{\Hypertarget{classSMImp_1_1TrustedParty_adc01721f3200888877174376a5b2464f}\label{classSMImp_1_1TrustedParty_adc01721f3200888877174376a5b2464f}} 
\index{S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}!register\+SM@{register\+SM}}
\index{register\+SM@{register\+SM}!S\+M\+Imp\+::\+Trusted\+Party@{S\+M\+Imp\+::\+Trusted\+Party}}
\subsubsection{\texorpdfstring{register\+S\+M()}{registerSM()}}
{\footnotesize\ttfamily void S\+M\+Imp\+::\+Trusted\+Party\+::register\+SM (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}

Adds Smart Meter\textquotesingle{}s id to the S\+M\+List. 

Definition at line 35 of file Trusted\+Party.\+cc.



References List$<$ T $>$\+::add().



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
src/crypto/\hyperlink{TrustedParty_8h}{Trusted\+Party.\+h}\item 
src/crypto/\hyperlink{TrustedParty_8cc}{Trusted\+Party.\+cc}\end{DoxyCompactItemize}
